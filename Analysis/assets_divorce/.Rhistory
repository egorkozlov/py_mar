ms_head<-subset(getNamesPSID("ER77601", cwf, years=years),select=c("variable"))$variable
#.Repair error
#impw2_ass[8]=NA
#impw2_deb[8]=NA
#ba_a2[8]=NA
#ba_d2[8]=NA
famvars = data.frame(iwy=iwy,iwm=iwm,year=years,age_w=age_w,head_hrs=head_hrs,head_li=head_li,
partner_li=partner_li,age=age,date=date,state=state,
wls=wls,mls=mls,eduf=eduf,mort1=mort1,mort2=mort2,ch_fu=ch_fu,
whet_partner_li=whet_partner_li,spouse_present=spouse_present,
hsw_sp=hsw_sp,hsw_re=hsw_re,cash=cash,bonds=bonds,stocks=stocks,
real_estate=real_estate,busval=busval,carval=carval,penval=penval,other_debt=other_debt,
impw2_ass=impw2_ass,impw2_deb=impw2_deb,ba_a2=ba_a2,ba_d2=ba_d2,other_debt2=other_debt2,
constructed_net_worth=constructed_net_worth,imputation_constructed_net_worth=imputation_constructed_net_worth,
house=house,twh=twh,n_fu=n_fu,non_fu=non_fu,hhid=hhid,family_li=family_li,mr_status_change=mr_status_change,ms_head=ms_head)
#famvars = data.frame(year=years,age_w=age_w,head_hrs=head_hrs,head_li=head_li,
#                     partner_li=partner_li,age=age,date=date,state=state,
#                     wls=wls,mls=mls,ms=ms,sex=sex,eduf=eduf,twh=twh)
sex[1:10]=sex[11]
indvars = data.frame(year=years,sex=sex,hea=hea,wgt=wgt,edu=edu,sequence_number=sequence_number,wmovein=wmovein)
# Build Datasets
path<-"C:\\Users\\Fabio\\Dropbox\\Data\\PSID\\Raw\\R"
data<-build.panel(fam.vars=famvars,ind.vars=indvars,datadir=path,design="all")
#Save on disk
write.csv(data,file='C:\\Users\\Fabio\\Dropbox\\py_mar_3\\Analysis\\assets_divorce\\assets.csv')
##################################################
#Get the PSID Data to get info on income process
##################################################
## remove (almost) everything in the working environment.
rm(list = ls())
library(psidR)
library(openxlsx)
require(data.table)
library(pracma)
#Years I want to consider: we ned both cohabitation and marriage
#years<-linspace(1997,2017,n=11
years<-c(1999,2001,2003,2005,2007,2009,2011,2013,2015,2017,2019)#
#Get variable names
#cwf = openxlsx::read.xlsx(system.file(package="psidR","psid-lists","psid.xlsx"))
cwf <- read.xlsx("http://psidonline.isr.umich.edu/help/xyr/psid.xlsx")
#Variables
ER30001<-subset(getNamesPSID("ER30001", cwf, years=years),select=c("variable"))$variable
ER30002<-subset(getNamesPSID("ER30002", cwf, years=years),select=c("variable"))$variable
date<-subset(getNamesPSID("ER60014", cwf, years=years),select=c("variable"))$variable
state<-subset(getNamesPSID("ER60003", cwf, years=years),select=c("variable"))$variable
age_w <- subset(getNamesPSID("ER60019", cwf, years=years),select=c("variable"))$variable
age<- subset(getNamesPSID("ER13010", cwf, years=years),select=c("variable"))$variable
#age<- c("ER10009","ER13010","ER17013","ER21017","ER25017","ER36017","ER42017","ER47317","ER53017","ER60017","ER66017")#""ER60019getNamesPSID("ER10009 ", cwf, years=years)
wls<-subset(getNamesPSID("ER65177", cwf, years=years),select=c("variable"))$variable
mls<-subset(getNamesPSID("ER60024", cwf, years=years),select=c("variable"))$variable
hea<-subset(getNamesPSID("ER34303", cwf, years=years),select=c("variable"))$variable
wgt<-subset(getNamesPSID("ER34413", cwf, years=years),select=c("variable"))$variable
sex<-subset(getNamesPSID("ER32000", cwf, years=years),select=c("variable"))$variable
edu<-subset(getNamesPSID("ER34349", cwf, years=years),select=c("variable"))$variable
eduf<-subset(getNamesPSID("ER65460", cwf, years=years),select=c("variable"))$variable
hsw_sp<-subset(getNamesPSID("ER66727", cwf, years=years),select=c("variable"))$variable
hsw_re<-subset(getNamesPSID("ER66714", cwf, years=years),select=c("variable"))$variable
head_hrs<-subset(getNamesPSID("ER57976", cwf, years=years),select=c("variable"))$variable
head_li<-subset(getNamesPSID("ER65216", cwf, years=years),select=c("variable"))$variable
partner_li<-subset(getNamesPSID("ER61349", cwf, years=years),select=c("variable"))$variable
family_li<-subset(getNamesPSID("ER77448", cwf, years=years),select=c("variable"))$variable
whet_partner_li<-subset(getNamesPSID("ER61348", cwf, years=years),select=c("variable"))$variable
spouse_present<-subset(getNamesPSID("ER67399", cwf, years=years),select=c("variable"))$variable
sequence_number<-subset(getNamesPSID("ER34302", cwf, years=years),select=c("variable"))$variable
ch_fu<-subset(getNamesPSID("ER66021", cwf, years=years),select=c("variable"))$variable
n_fu<-subset(getNamesPSID("ER66016", cwf, years=years),select=c("variable"))$variable
non_fu<-subset(getNamesPSID("ER66023", cwf, years=years),select=c("variable"))$variable
constructed_net_worth<-subset(getNamesPSID("ER77511", cwf, years=years),select=c("variable"))$variable
imputation_constructed_net_worth<-subset(getNamesPSID("ER77512", cwf, years=years),select=c("variable"))$variable
imputation_constructed_net_worth
constructed_net_worth
##################################################
#Get the PSID Data to get info on income process
##################################################
## remove (almost) everything in the working environment.
rm(list = ls())
library(psidR)
library(openxlsx)
require(data.table)
library(pracma)
#Years I want to consider: we ned both cohabitation and marriage
#years<-linspace(1997,2017,n=11
years<-c(1999,2001,2003,2005,2007,2009,2011,2013,2015,2017,2019)#
#Get variable names
#cwf = openxlsx::read.xlsx(system.file(package="psidR","psid-lists","psid.xlsx"))
cwf <- read.xlsx("http://psidonline.isr.umich.edu/help/xyr/psid.xlsx")
#Variables
ER30001<-subset(getNamesPSID("ER30001", cwf, years=years),select=c("variable"))$variable
ER30002<-subset(getNamesPSID("ER30002", cwf, years=years),select=c("variable"))$variable
date<-subset(getNamesPSID("ER60014", cwf, years=years),select=c("variable"))$variable
state<-subset(getNamesPSID("ER60003", cwf, years=years),select=c("variable"))$variable
age_w <- subset(getNamesPSID("ER60019", cwf, years=years),select=c("variable"))$variable
age<- subset(getNamesPSID("ER13010", cwf, years=years),select=c("variable"))$variable
#age<- c("ER10009","ER13010","ER17013","ER21017","ER25017","ER36017","ER42017","ER47317","ER53017","ER60017","ER66017")#""ER60019getNamesPSID("ER10009 ", cwf, years=years)
wls<-subset(getNamesPSID("ER65177", cwf, years=years),select=c("variable"))$variable
mls<-subset(getNamesPSID("ER60024", cwf, years=years),select=c("variable"))$variable
hea<-subset(getNamesPSID("ER34303", cwf, years=years),select=c("variable"))$variable
wgt<-subset(getNamesPSID("ER34413", cwf, years=years),select=c("variable"))$variable
sex<-subset(getNamesPSID("ER32000", cwf, years=years),select=c("variable"))$variable
edu<-subset(getNamesPSID("ER34349", cwf, years=years),select=c("variable"))$variable
eduf<-subset(getNamesPSID("ER65460", cwf, years=years),select=c("variable"))$variable
hsw_sp<-subset(getNamesPSID("ER66727", cwf, years=years),select=c("variable"))$variable
hsw_re<-subset(getNamesPSID("ER66714", cwf, years=years),select=c("variable"))$variable
head_hrs<-subset(getNamesPSID("ER57976", cwf, years=years),select=c("variable"))$variable
head_li<-subset(getNamesPSID("ER65216", cwf, years=years),select=c("variable"))$variable
partner_li<-subset(getNamesPSID("ER61349", cwf, years=years),select=c("variable"))$variable
family_li<-subset(getNamesPSID("ER77448", cwf, years=years),select=c("variable"))$variable
whet_partner_li<-subset(getNamesPSID("ER61348", cwf, years=years),select=c("variable"))$variable
spouse_present<-subset(getNamesPSID("ER67399", cwf, years=years),select=c("variable"))$variable
sequence_number<-subset(getNamesPSID("ER34302", cwf, years=years),select=c("variable"))$variable
ch_fu<-subset(getNamesPSID("ER66021", cwf, years=years),select=c("variable"))$variable
n_fu<-subset(getNamesPSID("ER66016", cwf, years=years),select=c("variable"))$variable
non_fu<-subset(getNamesPSID("ER66023", cwf, years=years),select=c("variable"))$variable
constructed_net_worth<-subset(getNamesPSID("ER77511", cwf, years=years),select=c("variable"))$variable
imputation_constructed_net_worth<-subset(getNamesPSID("ER77512", cwf, years=years),select=c("variable"))$variable
constructed_net_worth[1:5]=NA
imputation_constructed_net_worth[1:5]=NA
mort1<-subset(getNamesPSID("ER13047", cwf, years=years),select=c("variable"))$variable
mort2<-subset(getNamesPSID("ER13056", cwf, years=years),select=c("variable"))$variable
cash<-subset(getNamesPSID("ER15020", cwf, years=years),select=c("variable"))$variable
bonds<-subset(getNamesPSID("ER15026", cwf, years=years),select=c("variable"))$variable
stocks<-subset(getNamesPSID("ER15007", cwf, years=years),select=c("variable"))$variable
carval<-subset(getNamesPSID("ER14997", cwf, years=years),select=c("variable"))$variable
penval<-subset(getNamesPSID("ER15014", cwf, years=years),select=c("variable"))$variable
house<-subset(getNamesPSID("ER13041", cwf, years=years),select=c("variable"))$variable
twh<-subset(getNamesPSID("ER71485", cwf, years=years),select=c("variable"))$variable
#below miss 2013-
real_estate<-subset(getNamesPSID("ER14993", cwf, years=years),select=c("variable"))$variable
impw2_ass<-subset(getNamesPSID("ER71439", cwf, years=years),select=c("variable"))$variable
impw2_deb<-subset(getNamesPSID("ER71441", cwf, years=years),select=c("variable"))$variable
busval<-subset(getNamesPSID("ER15002", cwf, years=years),select=c("variable"))$variable
ba_a2<-subset(getNamesPSID("ER71429", cwf, years=years),select=c("variable"))$variable
ba_d2<-subset(getNamesPSID("ER71431", cwf, years=years),select=c("variable"))$variable
#below miss 2011-
other_debt<-subset(getNamesPSID("ER15031", cwf, years=years),select=c("variable"))$variable
other_debt2<-subset(getNamesPSID("ER71479", cwf, years=years),select=c("variable"))$variable
twh[1:6]=NA
iwy<-subset(getNamesPSID("ER66014", cwf, years=years),select=c("variable"))$variable
iwm<-subset(getNamesPSID("ER66012", cwf, years=years),select=c("variable"))$variable
wmovein<-subset(getNamesPSID("ER30006", cwf, years=years),select=c("variable"))$variable
hhid<-subset(getNamesPSID("ER71560", cwf, years=years),select=c("variable"))$variable
mr_status_change<-subset(getNamesPSID("ER77602", cwf, years=years),select=c("variable"))$variable
ms_head<-subset(getNamesPSID("ER77601", cwf, years=years),select=c("variable"))$variable
#.Repair error
#impw2_ass[8]=NA
#impw2_deb[8]=NA
#ba_a2[8]=NA
#ba_d2[8]=NA
famvars = data.frame(iwy=iwy,iwm=iwm,year=years,age_w=age_w,head_hrs=head_hrs,head_li=head_li,hea=hea,
partner_li=partner_li,age=age,date=date,state=state,
wls=wls,mls=mls,eduf=eduf,mort1=mort1,mort2=mort2,ch_fu=ch_fu,
whet_partner_li=whet_partner_li,spouse_present=spouse_present,
hsw_sp=hsw_sp,hsw_re=hsw_re,cash=cash,bonds=bonds,stocks=stocks,
real_estate=real_estate,busval=busval,carval=carval,penval=penval,other_debt=other_debt,
impw2_ass=impw2_ass,impw2_deb=impw2_deb,ba_a2=ba_a2,ba_d2=ba_d2,other_debt2=other_debt2,
constructed_net_worth=constructed_net_worth,imputation_constructed_net_worth=imputation_constructed_net_worth,
house=house,twh=twh,n_fu=n_fu,non_fu=non_fu,hhid=hhid,family_li=family_li,mr_status_change=mr_status_change,ms_head=ms_head)
#famvars = data.frame(year=years,age_w=age_w,head_hrs=head_hrs,head_li=head_li,
#                     partner_li=partner_li,age=age,date=date,state=state,
#                     wls=wls,mls=mls,ms=ms,sex=sex,eduf=eduf,twh=twh)
sex[1:10]=sex[11]
indvars = data.frame(year=years,sex=sex,hea=hea,wgt=wgt,edu=edu,sequence_number=sequence_number,wmovein=wmovein)
# Build Datasets
path<-"C:\\Users\\Fabio\\Dropbox\\Data\\PSID\\Raw\\R"
data<-build.panel(fam.vars=famvars,ind.vars=indvars,datadir=path,design="all")
##################################################
#Get the PSID Data to get info on income process
##################################################
## remove (almost) everything in the working environment.
rm(list = ls())
library(psidR)
library(openxlsx)
require(data.table)
library(pracma)
#Years I want to consider: we ned both cohabitation and marriage
#years<-linspace(1997,2017,n=11
years<-c(1999,2001,2003,2005,2007,2009,2011,2013,2015,2017,2019)#
#Get variable names
#cwf = openxlsx::read.xlsx(system.file(package="psidR","psid-lists","psid.xlsx"))
cwf <- read.xlsx("http://psidonline.isr.umich.edu/help/xyr/psid.xlsx")
#Variables
ER30001<-subset(getNamesPSID("ER30001", cwf, years=years),select=c("variable"))$variable
ER30002<-subset(getNamesPSID("ER30002", cwf, years=years),select=c("variable"))$variable
date<-subset(getNamesPSID("ER60014", cwf, years=years),select=c("variable"))$variable
state<-subset(getNamesPSID("ER60003", cwf, years=years),select=c("variable"))$variable
age_w <- subset(getNamesPSID("ER60019", cwf, years=years),select=c("variable"))$variable
age<- subset(getNamesPSID("ER13010", cwf, years=years),select=c("variable"))$variable
#age<- c("ER10009","ER13010","ER17013","ER21017","ER25017","ER36017","ER42017","ER47317","ER53017","ER60017","ER66017")#""ER60019getNamesPSID("ER10009 ", cwf, years=years)
wls<-subset(getNamesPSID("ER65177", cwf, years=years),select=c("variable"))$variable
mls<-subset(getNamesPSID("ER60024", cwf, years=years),select=c("variable"))$variable
hea<-subset(getNamesPSID("ER34303", cwf, years=years),select=c("variable"))$variable
wgt<-subset(getNamesPSID("ER34413", cwf, years=years),select=c("variable"))$variable
sex<-subset(getNamesPSID("ER32000", cwf, years=years),select=c("variable"))$variable
edu<-subset(getNamesPSID("ER34349", cwf, years=years),select=c("variable"))$variable
eduf<-subset(getNamesPSID("ER65460", cwf, years=years),select=c("variable"))$variable
hsw_sp<-subset(getNamesPSID("ER66727", cwf, years=years),select=c("variable"))$variable
hsw_re<-subset(getNamesPSID("ER66714", cwf, years=years),select=c("variable"))$variable
head_hrs<-subset(getNamesPSID("ER57976", cwf, years=years),select=c("variable"))$variable
head_li<-subset(getNamesPSID("ER65216", cwf, years=years),select=c("variable"))$variable
partner_li<-subset(getNamesPSID("ER61349", cwf, years=years),select=c("variable"))$variable
family_li<-subset(getNamesPSID("ER77448", cwf, years=years),select=c("variable"))$variable
whet_partner_li<-subset(getNamesPSID("ER61348", cwf, years=years),select=c("variable"))$variable
spouse_present<-subset(getNamesPSID("ER67399", cwf, years=years),select=c("variable"))$variable
sequence_number<-subset(getNamesPSID("ER34302", cwf, years=years),select=c("variable"))$variable
ch_fu<-subset(getNamesPSID("ER66021", cwf, years=years),select=c("variable"))$variable
n_fu<-subset(getNamesPSID("ER66016", cwf, years=years),select=c("variable"))$variable
non_fu<-subset(getNamesPSID("ER66023", cwf, years=years),select=c("variable"))$variable
constructed_net_worth<-subset(getNamesPSID("ER77511", cwf, years=years),select=c("variable"))$variable
imputation_constructed_net_worth<-subset(getNamesPSID("ER77512", cwf, years=years),select=c("variable"))$variable
constructed_net_worth[1:5]=NA
imputation_constructed_net_worth[1:5]=NA
mort1<-subset(getNamesPSID("ER13047", cwf, years=years),select=c("variable"))$variable
mort2<-subset(getNamesPSID("ER13056", cwf, years=years),select=c("variable"))$variable
cash<-subset(getNamesPSID("ER15020", cwf, years=years),select=c("variable"))$variable
bonds<-subset(getNamesPSID("ER15026", cwf, years=years),select=c("variable"))$variable
stocks<-subset(getNamesPSID("ER15007", cwf, years=years),select=c("variable"))$variable
carval<-subset(getNamesPSID("ER14997", cwf, years=years),select=c("variable"))$variable
penval<-subset(getNamesPSID("ER15014", cwf, years=years),select=c("variable"))$variable
house<-subset(getNamesPSID("ER13041", cwf, years=years),select=c("variable"))$variable
twh<-subset(getNamesPSID("ER71485", cwf, years=years),select=c("variable"))$variable
#below miss 2013-
real_estate<-subset(getNamesPSID("ER14993", cwf, years=years),select=c("variable"))$variable
impw2_ass<-subset(getNamesPSID("ER71439", cwf, years=years),select=c("variable"))$variable
impw2_deb<-subset(getNamesPSID("ER71441", cwf, years=years),select=c("variable"))$variable
busval<-subset(getNamesPSID("ER15002", cwf, years=years),select=c("variable"))$variable
ba_a2<-subset(getNamesPSID("ER71429", cwf, years=years),select=c("variable"))$variable
ba_d2<-subset(getNamesPSID("ER71431", cwf, years=years),select=c("variable"))$variable
#below miss 2011-
other_debt<-subset(getNamesPSID("ER15031", cwf, years=years),select=c("variable"))$variable
other_debt2<-subset(getNamesPSID("ER71479", cwf, years=years),select=c("variable"))$variable
twh[1:6]=NA
iwy<-subset(getNamesPSID("ER66014", cwf, years=years),select=c("variable"))$variable
iwm<-subset(getNamesPSID("ER66012", cwf, years=years),select=c("variable"))$variable
wmovein<-subset(getNamesPSID("ER30006", cwf, years=years),select=c("variable"))$variable
hhid<-subset(getNamesPSID("ER71560", cwf, years=years),select=c("variable"))$variable
mr_status_change<-subset(getNamesPSID("ER77602", cwf, years=years),select=c("variable"))$variable
ms_head<-subset(getNamesPSID("ER77601", cwf, years=years),select=c("variable"))$variable
#.Repair error
#impw2_ass[8]=NA
#impw2_deb[8]=NA
#ba_a2[8]=NA
#ba_d2[8]=NA
famvars = data.frame(iwy=iwy,iwm=iwm,year=years,age_w=age_w,head_hrs=head_hrs,head_li=head_li,
partner_li=partner_li,age=age,date=date,state=state,
wls=wls,mls=mls,eduf=eduf,mort1=mort1,mort2=mort2,ch_fu=ch_fu,
whet_partner_li=whet_partner_li,spouse_present=spouse_present,
hsw_sp=hsw_sp,hsw_re=hsw_re,cash=cash,bonds=bonds,stocks=stocks,
real_estate=real_estate,busval=busval,carval=carval,penval=penval,other_debt=other_debt,
impw2_ass=impw2_ass,impw2_deb=impw2_deb,ba_a2=ba_a2,ba_d2=ba_d2,other_debt2=other_debt2,
constructed_net_worth=constructed_net_worth,imputation_constructed_net_worth=imputation_constructed_net_worth,
house=house,twh=twh,n_fu=n_fu,non_fu=non_fu,hhid=hhid,family_li=family_li,mr_status_change=mr_status_change,ms_head=ms_head)
#famvars = data.frame(year=years,age_w=age_w,head_hrs=head_hrs,head_li=head_li,
#                     partner_li=partner_li,age=age,date=date,state=state,
#                     wls=wls,mls=mls,ms=ms,sex=sex,eduf=eduf,twh=twh)
sex[1:10]=sex[11]
indvars = data.frame(year=years,sex=sex,hea=hea,wgt=wgt,edu=edu,sequence_number=sequence_number,wmovein=wmovein)
# Build Datasets
path<-"C:\\Users\\Fabio\\Dropbox\\Data\\PSID\\Raw\\R"
data<-build.panel(fam.vars=famvars,ind.vars=indvars,datadir=path,design="all")
#Save on disk
write.csv(data,file='C:\\Users\\Fabio\\Dropbox\\py_mar_3\\Analysis\\assets_divorce\\assets.csv')
real_estate
penval
busval
other_debt
other_debt2
constructed_net_worth
constructed_net_worth
busval[6]
cash[6]
house[6]
carval[6]
stocks[6]
##################################################
#Get the PSID Data to get info on income process
##################################################
## remove (almost) everything in the working environment.
rm(list = ls())
library(psidR)
library(openxlsx)
require(data.table)
library(pracma)
#Years I want to consider: we ned both cohabitation and marriage
#years<-linspace(1997,2017,n=11
years<-c(1999,2001,2003,2005,2007,2009,2011,2013,2015,2017,2019)#
#Get variable names
#cwf = openxlsx::read.xlsx(system.file(package="psidR","psid-lists","psid.xlsx"))
cwf <- read.xlsx("http://psidonline.isr.umich.edu/help/xyr/psid.xlsx")
#Variables
ER30001<-subset(getNamesPSID("ER30001", cwf, years=years),select=c("variable"))$variable
ER30002<-subset(getNamesPSID("ER30002", cwf, years=years),select=c("variable"))$variable
date<-subset(getNamesPSID("ER60014", cwf, years=years),select=c("variable"))$variable
state<-subset(getNamesPSID("ER60003", cwf, years=years),select=c("variable"))$variable
age_w <- subset(getNamesPSID("ER60019", cwf, years=years),select=c("variable"))$variable
age<- subset(getNamesPSID("ER13010", cwf, years=years),select=c("variable"))$variable
#age<- c("ER10009","ER13010","ER17013","ER21017","ER25017","ER36017","ER42017","ER47317","ER53017","ER60017","ER66017")#""ER60019getNamesPSID("ER10009 ", cwf, years=years)
wls<-subset(getNamesPSID("ER65177", cwf, years=years),select=c("variable"))$variable
mls<-subset(getNamesPSID("ER60024", cwf, years=years),select=c("variable"))$variable
hea<-subset(getNamesPSID("ER34303", cwf, years=years),select=c("variable"))$variable
wgt<-subset(getNamesPSID("ER34413", cwf, years=years),select=c("variable"))$variable
sex<-subset(getNamesPSID("ER32000", cwf, years=years),select=c("variable"))$variable
edu<-subset(getNamesPSID("ER34349", cwf, years=years),select=c("variable"))$variable
eduf<-subset(getNamesPSID("ER65460", cwf, years=years),select=c("variable"))$variable
hsw_sp<-subset(getNamesPSID("ER66727", cwf, years=years),select=c("variable"))$variable
hsw_re<-subset(getNamesPSID("ER66714", cwf, years=years),select=c("variable"))$variable
head_hrs<-subset(getNamesPSID("ER57976", cwf, years=years),select=c("variable"))$variable
head_li<-subset(getNamesPSID("ER65216", cwf, years=years),select=c("variable"))$variable
partner_li<-subset(getNamesPSID("ER61349", cwf, years=years),select=c("variable"))$variable
family_li<-subset(getNamesPSID("ER77448", cwf, years=years),select=c("variable"))$variable
whet_partner_li<-subset(getNamesPSID("ER61348", cwf, years=years),select=c("variable"))$variable
spouse_present<-subset(getNamesPSID("ER67399", cwf, years=years),select=c("variable"))$variable
sequence_number<-subset(getNamesPSID("ER34302", cwf, years=years),select=c("variable"))$variable
ch_fu<-subset(getNamesPSID("ER66021", cwf, years=years),select=c("variable"))$variable
n_fu<-subset(getNamesPSID("ER66016", cwf, years=years),select=c("variable"))$variable
non_fu<-subset(getNamesPSID("ER66023", cwf, years=years),select=c("variable"))$variable
constructed_net_worth<-subset(getNamesPSID("ER77511", cwf, years=years),select=c("variable"))$variable
imputation_constructed_net_worth<-subset(getNamesPSID("ER77512", cwf, years=years),select=c("variable"))$variable
constructed_net_worth[1:5]=NA
imputation_constructed_net_worth[1:5]=NA
mort1<-subset(getNamesPSID("ER13047", cwf, years=years),select=c("variable"))$variable
mort2<-subset(getNamesPSID("ER13056", cwf, years=years),select=c("variable"))$variable
cash<-subset(getNamesPSID("ER15020", cwf, years=years),select=c("variable"))$variable
bonds<-subset(getNamesPSID("ER15026", cwf, years=years),select=c("variable"))$variable
stocks<-subset(getNamesPSID("ER15007", cwf, years=years),select=c("variable"))$variable
carval<-subset(getNamesPSID("ER14997", cwf, years=years),select=c("variable"))$variable
penval<-subset(getNamesPSID("ER15014", cwf, years=years),select=c("variable"))$variable
house<-subset(getNamesPSID("ER13041", cwf, years=years),select=c("variable"))$variable
twh<-subset(getNamesPSID("ER71485", cwf, years=years),select=c("variable"))$variable
#below miss 2013-
real_estate<-subset(getNamesPSID("ER14993", cwf, years=years),select=c("variable"))$variable
impw2_ass<-subset(getNamesPSID("ER71439", cwf, years=years),select=c("variable"))$variable
impw2_deb<-subset(getNamesPSID("ER71441", cwf, years=years),select=c("variable"))$variable
busval<-subset(getNamesPSID("ER15002", cwf, years=years),select=c("variable"))$variable
ba_a2<-subset(getNamesPSID("ER71429", cwf, years=years),select=c("variable"))$variable
ba_d2<-subset(getNamesPSID("ER71431", cwf, years=years),select=c("variable"))$variable
#below miss 2011-
other_debt<-subset(getNamesPSID("ER15031", cwf, years=years),select=c("variable"))$variable
other_debt2<-subset(getNamesPSID("ER71479", cwf, years=years),select=c("variable"))$variable
twh[1:6]=NA
iwy<-subset(getNamesPSID("ER66014", cwf, years=years),select=c("variable"))$variable
iwm<-subset(getNamesPSID("ER66012", cwf, years=years),select=c("variable"))$variable
wmovein<-subset(getNamesPSID("ER30006", cwf, years=years),select=c("variable"))$variable
hhid<-subset(getNamesPSID("ER71560", cwf, years=years),select=c("variable"))$variable
mr_status_change<-subset(getNamesPSID("ER77602", cwf, years=years),select=c("variable"))$variable
ms_head<-subset(getNamesPSID("ER77601", cwf, years=years),select=c("variable"))$variable
a1<-subset(getNamesPSID("ER46966", cwf, years=years),select=c("variable"))$variable
a2<-subset(getNamesPSID("ER46964", cwf, years=years),select=c("variable"))$variable
a3<-subset(getNamesPSID("ER46960", cwf, years=years),select=c("variable"))$variable
a4<-subset(getNamesPSID("ER46956 ", cwf, years=years),select=c("variable"))$variable
a5<-subset(getNamesPSID("ER46954", cwf, years=years),select=c("variable"))$variable
a6<-subset(getNamesPSID("ER46950", cwf, years=years),select=c("variable"))$variable
a7<-subset(getNamesPSID("ER46942 ", cwf, years=years),select=c("variable"))$variable
a8<-subset(getNamesPSID("ER46938", cwf, years=years),select=c("variable"))$variable
d1<-subset(getNamesPSID("ER46946", cwf, years=years),select=c("variable"))$variable
#.Repair error
#impw2_ass[8]=NA
#impw2_deb[8]=NA
#ba_a2[8]=NA
#ba_d2[8]=NA
famvars = data.frame(iwy=iwy,iwm=iwm,year=years,age_w=age_w,head_hrs=head_hrs,head_li=head_li,
partner_li=partner_li,age=age,date=date,state=state,
wls=wls,mls=mls,eduf=eduf,mort1=mort1,mort2=mort2,ch_fu=ch_fu,
whet_partner_li=whet_partner_li,spouse_present=spouse_present,
a1=a1,a2=a2,a3=a3,a4=a4,a5=a5,a6=a6,a7=a7,a8=a8,d1=d1,
hsw_sp=hsw_sp,hsw_re=hsw_re,cash=cash,bonds=bonds,stocks=stocks,
real_estate=real_estate,busval=busval,carval=carval,penval=penval,other_debt=other_debt,
impw2_ass=impw2_ass,impw2_deb=impw2_deb,ba_a2=ba_a2,ba_d2=ba_d2,other_debt2=other_debt2,
constructed_net_worth=constructed_net_worth,imputation_constructed_net_worth=imputation_constructed_net_worth,
house=house,twh=twh,n_fu=n_fu,non_fu=non_fu,hhid=hhid,family_li=family_li,mr_status_change=mr_status_change,ms_head=ms_head)
#famvars = data.frame(year=years,age_w=age_w,head_hrs=head_hrs,head_li=head_li,
#                     partner_li=partner_li,age=age,date=date,state=state,
#                     wls=wls,mls=mls,ms=ms,sex=sex,eduf=eduf,twh=twh)
sex[1:10]=sex[11]
indvars = data.frame(year=years,sex=sex,hea=hea,wgt=wgt,edu=edu,sequence_number=sequence_number,wmovein=wmovein)
# Build Datasets
path<-"C:\\Users\\Fabio\\Dropbox\\Data\\PSID\\Raw\\R"
data<-build.panel(fam.vars=famvars,ind.vars=indvars,datadir=path,design="all")
a1
a2
a3
a4
a5
a6
a7
a8
subset(getNamesPSID("ER46956 ", cwf, years=years),select=c("variable"))$variable
a1<-subset(getNamesPSID("ER46966", cwf, years=years),select=c("variable"))$variable
a2<-subset(getNamesPSID("ER46964", cwf, years=years),select=c("variable"))$variable
a3<-subset(getNamesPSID("ER46960", cwf, years=years),select=c("variable"))$variable
a4<-subset(getNamesPSID("ER46956", cwf, years=years),select=c("variable"))$variable
a5<-subset(getNamesPSID("ER46954", cwf, years=years),select=c("variable"))$variable
a6<-subset(getNamesPSID("ER46950", cwf, years=years),select=c("variable"))$variable
a7<-subset(getNamesPSID("ER46942", cwf, years=years),select=c("variable"))$variable
a8<-subset(getNamesPSID("ER46938", cwf, years=years),select=c("variable"))$variable
d1<-subset(getNamesPSID("ER46946", cwf, years=years),select=c("variable"))$variable
##################################################
#Get the PSID Data to get info on income process
##################################################
## remove (almost) everything in the working environment.
rm(list = ls())
library(psidR)
library(openxlsx)
require(data.table)
library(pracma)
#Years I want to consider: we ned both cohabitation and marriage
#years<-linspace(1997,2017,n=11
years<-c(1999,2001,2003,2005,2007,2009,2011,2013,2015,2017,2019)#
#Get variable names
#cwf = openxlsx::read.xlsx(system.file(package="psidR","psid-lists","psid.xlsx"))
cwf <- read.xlsx("http://psidonline.isr.umich.edu/help/xyr/psid.xlsx")
#Variables
ER30001<-subset(getNamesPSID("ER30001", cwf, years=years),select=c("variable"))$variable
ER30002<-subset(getNamesPSID("ER30002", cwf, years=years),select=c("variable"))$variable
date<-subset(getNamesPSID("ER60014", cwf, years=years),select=c("variable"))$variable
state<-subset(getNamesPSID("ER60003", cwf, years=years),select=c("variable"))$variable
age_w <- subset(getNamesPSID("ER60019", cwf, years=years),select=c("variable"))$variable
age<- subset(getNamesPSID("ER13010", cwf, years=years),select=c("variable"))$variable
#age<- c("ER10009","ER13010","ER17013","ER21017","ER25017","ER36017","ER42017","ER47317","ER53017","ER60017","ER66017")#""ER60019getNamesPSID("ER10009 ", cwf, years=years)
wls<-subset(getNamesPSID("ER65177", cwf, years=years),select=c("variable"))$variable
mls<-subset(getNamesPSID("ER60024", cwf, years=years),select=c("variable"))$variable
hea<-subset(getNamesPSID("ER34303", cwf, years=years),select=c("variable"))$variable
wgt<-subset(getNamesPSID("ER34413", cwf, years=years),select=c("variable"))$variable
sex<-subset(getNamesPSID("ER32000", cwf, years=years),select=c("variable"))$variable
edu<-subset(getNamesPSID("ER34349", cwf, years=years),select=c("variable"))$variable
eduf<-subset(getNamesPSID("ER65460", cwf, years=years),select=c("variable"))$variable
hsw_sp<-subset(getNamesPSID("ER66727", cwf, years=years),select=c("variable"))$variable
hsw_re<-subset(getNamesPSID("ER66714", cwf, years=years),select=c("variable"))$variable
head_hrs<-subset(getNamesPSID("ER57976", cwf, years=years),select=c("variable"))$variable
head_li<-subset(getNamesPSID("ER65216", cwf, years=years),select=c("variable"))$variable
partner_li<-subset(getNamesPSID("ER61349", cwf, years=years),select=c("variable"))$variable
family_li<-subset(getNamesPSID("ER77448", cwf, years=years),select=c("variable"))$variable
whet_partner_li<-subset(getNamesPSID("ER61348", cwf, years=years),select=c("variable"))$variable
spouse_present<-subset(getNamesPSID("ER67399", cwf, years=years),select=c("variable"))$variable
sequence_number<-subset(getNamesPSID("ER34302", cwf, years=years),select=c("variable"))$variable
ch_fu<-subset(getNamesPSID("ER66021", cwf, years=years),select=c("variable"))$variable
n_fu<-subset(getNamesPSID("ER66016", cwf, years=years),select=c("variable"))$variable
non_fu<-subset(getNamesPSID("ER66023", cwf, years=years),select=c("variable"))$variable
constructed_net_worth<-subset(getNamesPSID("ER77511", cwf, years=years),select=c("variable"))$variable
imputation_constructed_net_worth<-subset(getNamesPSID("ER77512", cwf, years=years),select=c("variable"))$variable
constructed_net_worth[1:5]=NA
imputation_constructed_net_worth[1:5]=NA
mort1<-subset(getNamesPSID("ER13047", cwf, years=years),select=c("variable"))$variable
mort2<-subset(getNamesPSID("ER13056", cwf, years=years),select=c("variable"))$variable
cash<-subset(getNamesPSID("ER15020", cwf, years=years),select=c("variable"))$variable
bonds<-subset(getNamesPSID("ER15026", cwf, years=years),select=c("variable"))$variable
stocks<-subset(getNamesPSID("ER15007", cwf, years=years),select=c("variable"))$variable
carval<-subset(getNamesPSID("ER14997", cwf, years=years),select=c("variable"))$variable
penval<-subset(getNamesPSID("ER15014", cwf, years=years),select=c("variable"))$variable
house<-subset(getNamesPSID("ER13041", cwf, years=years),select=c("variable"))$variable
twh<-subset(getNamesPSID("ER71485", cwf, years=years),select=c("variable"))$variable
#below miss 2013-
real_estate<-subset(getNamesPSID("ER14993", cwf, years=years),select=c("variable"))$variable
impw2_ass<-subset(getNamesPSID("ER71439", cwf, years=years),select=c("variable"))$variable
impw2_deb<-subset(getNamesPSID("ER71441", cwf, years=years),select=c("variable"))$variable
busval<-subset(getNamesPSID("ER15002", cwf, years=years),select=c("variable"))$variable
ba_a2<-subset(getNamesPSID("ER71429", cwf, years=years),select=c("variable"))$variable
ba_d2<-subset(getNamesPSID("ER71431", cwf, years=years),select=c("variable"))$variable
#below miss 2011-
other_debt<-subset(getNamesPSID("ER15031", cwf, years=years),select=c("variable"))$variable
other_debt2<-subset(getNamesPSID("ER71479", cwf, years=years),select=c("variable"))$variable
twh[1:6]=NA
iwy<-subset(getNamesPSID("ER66014", cwf, years=years),select=c("variable"))$variable
iwm<-subset(getNamesPSID("ER66012", cwf, years=years),select=c("variable"))$variable
wmovein<-subset(getNamesPSID("ER30006", cwf, years=years),select=c("variable"))$variable
hhid<-subset(getNamesPSID("ER71560", cwf, years=years),select=c("variable"))$variable
mr_status_change<-subset(getNamesPSID("ER77602", cwf, years=years),select=c("variable"))$variable
ms_head<-subset(getNamesPSID("ER77601", cwf, years=years),select=c("variable"))$variable
a1<-subset(getNamesPSID("ER46966", cwf, years=years),select=c("variable"))$variable
a2<-subset(getNamesPSID("ER46964", cwf, years=years),select=c("variable"))$variable
a3<-subset(getNamesPSID("ER46960", cwf, years=years),select=c("variable"))$variable
a4<-subset(getNamesPSID("ER46956", cwf, years=years),select=c("variable"))$variable
a5<-subset(getNamesPSID("ER46954", cwf, years=years),select=c("variable"))$variable
a6<-subset(getNamesPSID("ER46950", cwf, years=years),select=c("variable"))$variable
a7<-subset(getNamesPSID("ER46942", cwf, years=years),select=c("variable"))$variable
a8<-subset(getNamesPSID("ER46938", cwf, years=years),select=c("variable"))$variable
d1<-subset(getNamesPSID("ER46946", cwf, years=years),select=c("variable"))$variable
a1[1:5]=NA
a2[1:5]=NA
a3[1:5]=NA
a4[1:5]=NA
a5[1:5]=NA
a6[1:5]=NA
a7[1:5]=NA
a8[1:5]=NA
d1[1:5]=NA
#.Repair error
#impw2_ass[8]=NA
#impw2_deb[8]=NA
#ba_a2[8]=NA
#ba_d2[8]=NA
famvars = data.frame(iwy=iwy,iwm=iwm,year=years,age_w=age_w,head_hrs=head_hrs,head_li=head_li,
partner_li=partner_li,age=age,date=date,state=state,
wls=wls,mls=mls,eduf=eduf,mort1=mort1,mort2=mort2,ch_fu=ch_fu,
whet_partner_li=whet_partner_li,spouse_present=spouse_present,
a1=a1,a2=a2,a3=a3,a4=a4,a5=a5,a6=a6,a7=a7,a8=a8,d1=d1,
hsw_sp=hsw_sp,hsw_re=hsw_re,cash=cash,bonds=bonds,stocks=stocks,
real_estate=real_estate,busval=busval,carval=carval,penval=penval,other_debt=other_debt,
impw2_ass=impw2_ass,impw2_deb=impw2_deb,ba_a2=ba_a2,ba_d2=ba_d2,other_debt2=other_debt2,
constructed_net_worth=constructed_net_worth,imputation_constructed_net_worth=imputation_constructed_net_worth,
house=house,twh=twh,n_fu=n_fu,non_fu=non_fu,hhid=hhid,family_li=family_li,mr_status_change=mr_status_change,ms_head=ms_head)
#famvars = data.frame(year=years,age_w=age_w,head_hrs=head_hrs,head_li=head_li,
#                     partner_li=partner_li,age=age,date=date,state=state,
#                     wls=wls,mls=mls,ms=ms,sex=sex,eduf=eduf,twh=twh)
sex[1:10]=sex[11]
indvars = data.frame(year=years,sex=sex,hea=hea,wgt=wgt,edu=edu,sequence_number=sequence_number,wmovein=wmovein)
# Build Datasets
path<-"C:\\Users\\Fabio\\Dropbox\\Data\\PSID\\Raw\\R"
data<-build.panel(fam.vars=famvars,ind.vars=indvars,datadir=path,design="all")
#Save on disk
write.csv(data,file='C:\\Users\\Fabio\\Dropbox\\py_mar_3\\Analysis\\assets_divorce\\assets.csv')
subset(getNamesPSID("ER46956 ", cwf, years=years),select=c("variable"))$variable
bonds
